bind_cols(dados) %>%
rename(dist_centroid = '...1') %>%
mutate(flag = ifelse(dist_centroid < quantile(dist_centroid, probs = 0.90), "OK",
ifelse(dist_centroid >= quantile(dist_centroid, probs = 0.90) & dist_centroid < quantile(dist_centroid, probs = 0.95), "check > Q90",
ifelse(dist_centroid >= quantile(dist_centroid, probs = 0.95), "check > Q95", "OK"))))
print(dados2)
}
# classificar ocorrências
marcados <- velvet$data %>%
data.frame() %>%
dplyr::select(scientificName, decimalLongitude, decimalLatitude, datasetName) %>%
distinct() %>%
flag_outlier(., species = "Barbourisia rufa (Parr, 1945)")
# mapa
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude,
color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
# mapa
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude,
color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
setwd("C:/Users/Hanny/Downloads/Ciências de Dados 2025")
# mapa
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude,
color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
# classificar ocorrências
marcados <- velvet$data %>%
data.frame() %>%
dplyr::select(scientificName, decimalLongitude, decimalLatitude, datasetName) %>%
distinct() %>%
flag_outlier(., species = "Barbourisia rufa (Parr, 1945)")
# mapa
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude,
color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
marcados <- velvet$data %>%
data.frame() %>%
dplyr::select(scientificName, decimalLongitude, decimalLatitude, datasetName) %>%
distinct() %>%
flag_outlier(., species = "Barbourisia rufa (Parr, 1945)")
# mapa
ggplot()
# mapa
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude,
color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
marcados <- velvet$data %>%
data.frame() %>%
dplyr::select(scientificName, decimalLongitude, decimalLatitude, datasetName) %>%
distinct() %>%
flag_outlier(., species = "Barbourisia rufa (Parr, 1945)")
# mapa
ggplot()
geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude,
color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
# classificar ocorrências
marcados <- velvet$data %>%
data.frame() %>%
dplyr::select(scientificName, decimalLongitude, decimalLatitude, datasetName) %>%
distinct() %>%
flag_outlier(., species = "Barbourisia rufa (Parr, 1945)")
library(ggplot2)
library(dplyr)
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude,
color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude,
color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
View(marcados)
library(maps)
library(mapdata)
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude,
color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
marcados <- velvet$data %>%
data.frame() %>%
dplyr::select(scientificName, decimalLongitude, decimalLatitude, datasetName) %>%
distinct() %>%
flag_outlier(., species = "Barbourisia rufa (Parr, 1945)")
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude,
color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
ggplot()
geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude,
color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
world <- map_data("world")
ggplot()
geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude,
color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
marcados <- velvet$data %>%
data.frame() %>%
dplyr::select(scientificName, decimalLongitude, decimalLatitude, datasetName) %>%
distinct() %>%
flag_outlier(., species = "Barbourisia rufa (Parr, 1945)")
ggplot()
geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude,
color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude,
color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
world <- map_data("world")
#####
print(
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude, color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
)
#####
print(
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude, color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
)
#####
mapa <- ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude, color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
#####
View(marcados)
head(marcados)
str(marcados)
nrow(marcados)
nrow(marcados)
marcados <- velvet$data %>%
dplyr::select(scientificName, decimalLongitude, decimalLatitude, datasetName) %>%
distinct() %>%
flag_outlier(., species = "Barbourisia rufa (Parr, 1945)")
unique(velvet$data$scientificName)
nrow(marcados)
unique(velvet$data$scientificName)
marcados <- velvet$data %>%
dplyr::select(scientificName, decimalLongitude, decimalLatitude, datasetName) %>%
distinct() %>%
flag_outlier(., species = "Barbourisia rufa (Parr, 1945)")
unique(velvet$data$scientificName)
marcados <- velvet$data %>%
dplyr::filter(scientificName == "Barbourisia rufa")
nrow(marcados)
unique(velvet$data$scientificName)
library(mapdata)
#####
library(ggplot2)
library(dplyr)
library(maps)
library(mapdata)
world <- map_data("world")
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group), fill = "gray90", color = "white") +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude, color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group), fill = "gray90", color = "white") +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude, color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
library(stringr)
world <- map_data("world")
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group), fill = "gray90", color = "white") +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude, color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group), fill = "gray90", color = "white") +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude, color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
#####
library(ggplot2)
library(dplyr)
library(maps)
library(mapdata)
library(stringr)
marcados <- velvet$data %>%
filter(str_detect(scientificName, fixed("Barbourisia rufa"))) %>%
select(scientificName, decimalLongitude, decimalLatitude, datasetName) %>%
distinct()
nrow(marcados)
world <- map_data("world")
gplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group),
fill = "gray90", color = "white") +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude),
color = "darkred", size = 2, alpha = 0.7) +
labs(x = "Longitude", y = "Latitude",
title = expression(italic("Barbourisia rufa"))) +
theme(legend.position = "none")
gplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group),
fill = "gray90", color = "white") +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude),
color = "darkred", size = 2, alpha = 0.7) +
labs(x = "Longitude", y = "Latitude",
title = expression(italic("Barbourisia rufa"))) +
theme(legend.position = "none")
gplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group),
fill = "gray90", color = "white") +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes (color= flag)
aes(x = decimalLongitude, y = decimalLatitude),
gplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group),
fill = "gray90", color = "white") +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes (color= flag),
aes(x = decimalLongitude, y = decimalLatitude),
color = "darkred", size = 2, alpha = 0.7) +
labs(x = "Longitude", y = "Latitude",
title = expression(italic("Barbourisia rufa"))) +
theme(legend.position = "none")
gplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group),
fill = "gray90", color = "white") +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude),
color = "darkred", size = 2, alpha = 0.7) +
labs(x = "Longitude", y = "Latitude",
title = expression(italic("Barbourisia rufa"))) +
theme(legend.position = "none")
gplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group),
fill = "gray90", color = "white") +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude),
color = "darkred", size = 2, alpha = 0.7) +
labs(x = "Longitude", y = "Latitude",
title = expression(italic("Barbourisia rufa"))) +
theme(legend.position = "none")
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group),
fill = "gray90", color = "white") +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude),
color = "darkred", size = 2, alpha = 0.7) +
labs(x = "Longitude", y = "Latitude",
title = expression(italic("Barbourisia rufa"))) +
theme(legend.position = "none")
library(ggplot2)
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group),
fill = "gray90", color = "white") +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude),
color = "darkred", size = 2, alpha = 0.7) +
labs(x = "Longitude", y = "Latitude",
title = expression(italic("Barbourisia rufa"))) +
theme(legend.position = "none")
world <- map_data("world")
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group),
fill = "gray90", color = "white") +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude),
color = "darkred", size = 2, alpha = 0.7) +
labs(x = "Longitude", y = "Latitude",
title = expression(italic("Barbourisia rufa"))) +
theme(legend.position = "none")
marcados <- velvet_final %>%
filter(str_detect(scientificName, fixed("Barbourisia rufa"))) %>%
select(scientificName, decimalLongitude, decimalLatitude, datasetName) %>%
distinct()
#########
library(ggplot2)
library(dplyr)
library(maps)
library(mapdata)
library(stringr)
marcados <- velvet_final %>%
filter(str_detect(scientificName, fixed("Barbourisia rufa"))) %>%
select(scientificName, decimalLongitude, decimalLatitude, datasetName) %>%
distinct()
nrow(marcados)
world <- map_data("world")
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group),
fill = "gray90", color = "white") +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude),
color = "darkred", size = 2, alpha = 0.7) +
labs(x = "Longitude", y = "Latitude",
title = expression(italic("Barbourisia rufa"))) +
theme(legend.position = "none")
#####
# mapa
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude,
color = flag)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group),
fill = "gray90", color = "white") +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude),
color = "darkred", size = 2, alpha = 0.7) +
labs(x = "Longitude", y = "Latitude",
title = expression(italic("Barbourisia rufa"))) +
theme(legend.position = "none")
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group),
fill = "gray60", color = "white") +
coord_fixed() +
theme_classic() +
geom_point(data = marcados,
aes(x = decimalLongitude, y = decimalLatitude),
color = "darkred", size = 2, alpha = 0.7) +
labs(x = "Longitude", y = "Latitude",
title = expression(italic("Barbourisia rufa"))) +
theme(legend.position = "none")
library(CoordinateCleaner)
flags <-
clean_coordinates(
x = marcados,
lon = "decimalLongitude",
lat = "decimalLatitude",
species = "scientificName",
tests = c("equal", "gbif",
"zeros", "seas")
)
###verificar outliers
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
coord_fixed() +
theme_classic() +
geom_point(data = marcados %>%
filter(flag != "OK"),
aes(x = decimalLongitude, y = decimalLatitude,
color = datasetName)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
###criar coluna flag
marcados <- marcados %>%
mutate(flag = ifelse(decimalLongitude >= -180 & decimalLongitude <= 180 &
decimalLatitude >= -90 & decimalLatitude <= 90,
"OK", "Check"))
ggplot() +
geom_polygon(data = world, aes(x = long, y = lat, group = group)) +
coord_fixed() +
theme_classic() +
geom_point(data = marcados %>%
filter(flag != "OK"),
aes(x = decimalLongitude, y = decimalLatitude,
color = datasetName)) +
theme(legend.title = element_blank()) +
labs(x = "longitude", y = "latitude",
title = expression(italic("Barbourisia rufa")))
library(tidyverse)
